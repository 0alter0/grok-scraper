<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Grok Seeker</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta property="og:title" content="Grok Seeker" />
  <meta property="og:description" content="Search Grok conversations. Made by Lil Skittle" />
  <meta property="og:type" content="website" />
  <style>
    :root {
      --grokred: #E67C73;
      --bg-dark: #0d0d0d;
      --text-light: #e0e0e0;
      --input-bg: #1a1a1a;
      --border: #2a2a2a;
    }
    body {
      background: var(--bg-dark);
      color: var(--text-light);
      font-family: Inter, "Segoe UI", system-ui, sans-serif;
      padding: 60px 20px;
      margin: 0;
      text-align: center;
    }
    h1 {
      font-size: 2.3rem;
      color: var(--grokred);
      margin-bottom: 30px;
      font-weight: 500;
    }
    #cse {
      max-width: 720px;
      margin: 0 auto;
      text-align: left; 
    }
    .gsc-input {
      background: var(--input-bg) !important;
      color: var(--text-light) !important;
      border: 1px solid var(--border) !important;
      border-radius: 6px !important;
      padding: 8px !important;
      font-size: 1rem !important;
    }
    .gsc-input:focus {
      outline: none !important;
      border-color: var(--grokred) !important;
      box-shadow: 0 0 0 3px rgba(16,163,127,0.08);
    }
    @media (max-width:600px) {
      h1 { font-size: 1.8rem; }
    }
  </style>
</head>
<body>
  <h1>Grok Seeker</h1>
  <div id="cse"></div>
  <script>
    const CSE_CX = "35b75e2311fd44b19";
    
    const LOGGING_URL = "https://script.google.com/macros/s/AKfycbzQ5v35CtikQ895FUgiCmFtYon8X9n2tnzMqwb1Zk41S74HmwN_2Dyv6oG8mB--0H5LQQ/exec";
    
    window.__gcse = {
      parsetags: 'explicit',
      callback: function() {
        try {
          if (window.google && google.search && google.search.cse && google.search.cse.element) {
            google.search.cse.element.render({
              div: "cse",
              tag: "search"
            });
            enhanceStyling();
            startLinkObserver();
          } else {
            console.warn("CSE script loaded but render API missing.");
          }
        } catch (err) {
          console.error("CSE render failed:", err);
        }
      }
    };
    
    (function loadCSE() {
      const s = document.createElement('script');
      s.src = "https://cse.google.com/cse.js?cx=" + encodeURIComponent(CSE_CX);
      s.async = true;
      s.defer = true;
      s.onload = function() {
        console.log("CSE script loaded successfully");
      };
      s.onerror = function(e) {
        console.error("Failed to load Google CSE script. This may be due to browser restrictions or CSE configuration.", e);
        document.getElementById('cse').innerHTML = '<p style="color: #e74c3c; padding: 20px; background: var(--input-bg); border-radius: 6px;">Error loading search engine. Please try opening this page in a separate browser tab or check your CSE configuration.</p>';
      };
      document.head.appendChild(s);
    })();
    
    function enhanceStyling() {
      const tryApply = () => {
        const input = document.querySelector('.gsc-input');
        if (input) {
          input.setAttribute('placeholder', 'Search Grok or public sitesâ€¦');
        } else {
          retryCount++;
          if (retryCount < 10) setTimeout(tryApply, 250);
        }
      };
      let retryCount = 0;
      tryApply();
    }
    
    function startLinkObserver() {
      console.log("Link observer started");
      console.log("Logging endpoint:", LOGGING_URL);
      
      const processLinks = () => {
        const links = document.querySelectorAll('a[href*="grok.com/share/"]');
        console.log("Found links:", links.length);
        
        links.forEach(link => {
          const url = link.href;
          console.log("Checking link:", url);
          
          if (!link.dataset.logged && /^https:\/\/grok\.com\/share\/[a-zA-Z0-9\-_]+$/.test(url)) {
            link.dataset.logged = "true";
            
            const title = link.textContent.trim() || link.innerText.trim() || url;
            
            const logUrl = LOGGING_URL + "?url=" + encodeURIComponent(url) + "&title=" + encodeURIComponent(title);
            
            console.log("âœ“ VALID Grok link found:", url);
            console.log("ðŸ“¤ Sending request to:", logUrl);
            
            const img = new Image();
            img.onload = () => console.log("Image request completed");
            img.onerror = () => console.log("Image request sent (expected CORS error)");
            img.src = logUrl;
            
            fetch(logUrl, {
              method: 'GET',
              mode: 'no-cors',
              cache: 'no-cache'
            }).then(() => {
              console.log("âœ… Fetch request sent");
            }).catch(err => {
              console.error("âŒ Fetch error:", err);
            });
            
            try {
              const xhr = new XMLHttpRequest();
              xhr.open('GET', logUrl, true);
              xhr.send();
              console.log("âœ… XHR request sent");
            } catch (err) {
              console.error("âŒ XHR error:", err);
            }
            
          } else if (link.dataset.logged) {
            console.log("â­ï¸ Already logged:", url);
          } else {
            console.log("âŒ Invalid format:", url);
          }
        });
      };
      
      setTimeout(processLinks, 1000);
      
      const observer = new MutationObserver(() => {
        processLinks();
      });

      observer.observe(document.body, {
        childList: true,
        subtree: true
      });
      
      setInterval(processLinks, 3000);
    }
  </script>
</body>
</html>
